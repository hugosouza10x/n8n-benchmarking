#!/bin/bash

ulimit -n 10000
mkdir -p /home/ubuntu/vegeta/results

wget -O /home/ubuntu/vegeta/vegeta_12.8.4_linux_amd64.tar.gz https://github.com/tsenart/vegeta/releases/download/v12.8.4/vegeta_12.8.4_linux_amd64.tar.gz
tar -xf /home/ubuntu/vegeta/vegeta_12.8.4_linux_amd64.tar.gz -C /home/ubuntu/vegeta

sudo /home/ubuntu/vegeta/run_tests.sh 180 ${workerIp} ${queueWorkerIp1} ${queueWorkerIp2} ${queueWorkerIp3}
sudo /home/ubuntu/vegeta/results_to_csv.sh ${n8nMode} ${workerInstanceSize} ${resultsRecieverURL}